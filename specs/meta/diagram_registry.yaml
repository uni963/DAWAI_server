# DAWAI éšå±¤å‹ä»•æ§˜æ›¸2.0 - ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ç™»éŒ²
version: 2.0.0
last_updated: 2025-01-22
project: DAWAI
implementation_base: current_codebase

# ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ æƒ…å ±ç®¡ç†
diagrams:
  # ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦å›³
  system_overview:
    L0:
      business_overview:
        path: overview/index.md
        title: "DAWAIãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å…¨ä½“åƒ"
        type: mindmap
        stakeholders: [executive, product_manager, user]
        mermaid_type: "graph TB"

  # ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³
  system_architecture:
    L1:
      overall_architecture:
        path: architecture/logical/L1_system.md
        title: "ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£"
        type: architecture
        parent: null
        children:
          - system_architecture/L2/frontend_detail
          - system_architecture/L2/backend_detail
        requirements: [FR-AUDIO-001, FR-AI-001, FR-PROJECT-001, FR-UI-001]
        implementation_refs:
          - frontend/src/App.jsx
          - backend/main.py
          - backend/ai_agent/main.py
        sync_status: âœ…

    L2:
      frontend_detail:
        path: architecture/logical/L2_frontend/index.md
        title: "React ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ§‹æˆ"
        type: component_diagram
        parent: system_architecture/L1/overall_architecture
        technologies: [React, Vite, Tone.js, Tailwind]
        implementation_refs:
          - frontend/src/
          - frontend/package.json
          - frontend/vite.config.js
        sync_status: ğŸ”„ # To be created

      backend_detail:
        path: architecture/logical/L2_backend/index.md
        title: "FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ§‹æˆ"
        type: component_diagram
        parent: system_architecture/L1/overall_architecture
        technologies: [FastAPI, Python, PyTorch, Uvicorn]
        implementation_refs:
          - backend/
          - backend/requirements.txt
        sync_status: ğŸ”„ # To be created

  # æ©Ÿèƒ½è¦ä»¶å›³
  functional_requirements:
    L1:
      requirements_overview:
        path: requirements/functional/L1_index.md
        title: "æ©Ÿèƒ½è¦ä»¶ãƒãƒƒãƒ—"
        type: mindmap
        mermaid_type: "mindmap"
        coverage:
          audio_processing: 4
          ai_integration: 4
          project_management: 3
          ui_features: 4
        implementation_rate: "100%"
        sync_status: âœ…

    L2:
      audio_processing_detail:
        path: requirements/functional/L2_audio_processing/index.md
        title: "éŸ³å£°å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ"
        type: architecture
        parent: functional_requirements/L1/requirements_overview
        implementation_refs:
          - frontend/src/utils/unifiedAudioSystem.js
          - frontend/src/components/EnhancedMidiEditor.jsx
          - frontend/src/components/ArrangementView.jsx
          - frontend/src/components/DrumTrack/
        sync_status: âœ…

      ai_integration_detail:
        path: requirements/functional/L2_ai_integration/index.md
        title: "AIçµ±åˆã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ"
        type: architecture
        parent: functional_requirements/L1/requirements_overview
        implementation_refs:
          - backend/ai_agent/main.py
          - backend/diffsinger/
          - backend/ghost_text/
          - frontend/src/components/AIassistant/
        sync_status: âœ…

  # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³
  data_flows:
    L1:
      system_dataflow:
        path: architecture/logical/L1_system.md
        title: "ä¸»è¦ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼"
        type: sequence
        mermaid_type: "sequenceDiagram"
        entities: [User, "React UI", FastAPI, "AI Service", "Audio Engine"]
        flows: [chat_flow, audio_flow, ai_synthesis_flow, project_save_flow]
        sync_status: âœ…

  # ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³
  sequences:
    L0:
      business_flows:
        path: design/sequences/L0_business_flows.md
        title: "ãƒ“ã‚¸ãƒã‚¹ãƒ•ãƒ­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹"
        type: sequence
        mermaid_type: "sequenceDiagram"
        target_audience: [executive, product_manager, stakeholder]
        flows: [onboarding_flow, ai_collaboration_flow, platform_value_flow, market_impact_flow]
        sync_status: âœ…

    L1:
      system_flows:
        path: design/sequences/L1_system_flows.md
        title: "ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹"
        type: sequence
        mermaid_type: "sequenceDiagram"
        target_audience: [architect, senior_developer, pm]
        flows: [startup_flow, ai_chat_flow, audio_processing_flow, project_management_flow, diffsinger_flow, ghost_text_flow, performance_flow, security_flow]
        sync_status: âœ…

    L2:
      component_flows:
        path: design/sequences/L2_component_flows.md
        title: "ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ãƒ­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹"
        type: sequence
        mermaid_type: "sequenceDiagram"
        target_audience: [developer, domain_specialist]
        flows: [midi_editor_flow, multitrack_flow, drum_sequencer_flow, ai_switching_flow, diffsinger_synthesis_flow, ghost_text_completion_flow, visualization_flow, keyboard_shortcuts_flow, persistence_flow]
        sync_status: âœ…

    L3:
      implementation_flows:
        path: design/sequences/L3_implementation_flows.md
        title: "å®Ÿè£…è©³ç´°ãƒ•ãƒ­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹"
        type: sequence
        mermaid_type: "sequenceDiagram"
        target_audience: [implementation_developer, debugger]
        flows: [unified_audio_system_flow, canvas_implementation_flow, fastapi_ai_integration_flow, diffsinger_pipeline_flow, midi_persistence_hook_flow, ai_provider_switching_flow, audio_realtime_processing_flow, canvas_performance_flow, api_key_management_flow, cors_security_flow]
        sync_status: âœ…

# æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ãƒ«ãƒ¼ãƒ«
sync_rules:
  - name: requirement_implementation_mapping
    description: è¦ä»¶ã¨å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã®å¯¾å¿œç¢ºèª
    check_type: file_existence
    source: requirements/functional/
    target: implementation_refs
    severity: ERROR

  - name: diagram_hierarchy_consistency
    description: ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®éšå±¤æ•´åˆæ€§ç¢ºèª
    check_type: hierarchy_validation
    source: parent
    target: children
    severity: WARNING

  - name: implementation_sync_status
    description: å®Ÿè£…ã¨ã®åŒæœŸçŠ¶æ…‹ç¢ºèª
    check_type: sync_status_validation
    target: sync_status
    severity: INFO

  - name: mermaid_syntax_validation
    description: Mermaidãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®æ§‹æ–‡ç¢ºèª
    check_type: syntax_validation
    target: mermaid_type
    severity: WARNING

# è‡ªå‹•ç”Ÿæˆè¨­å®š
auto_generation:
  navigation_links:
    enabled: true
    update_frequency: "on_change"

  cross_references:
    enabled: true
    link_format: "[{title}]({path})"

  implementation_tracking:
    enabled: true
    scan_directories: ["frontend/src/", "backend/"]

# æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
validation_status:
  last_check: "2025-01-22T11:00:00Z"
  total_diagrams: 12
  validated_diagrams: 9
  pending_diagrams: 3
  errors: 0
  warnings: 0

  detailed_status:
    system_overview: âœ…
    system_architecture: âœ…
    functional_requirements: âœ…
    data_flows: âœ…
    sequences_L0: âœ…
    sequences_L1: âœ…
    sequences_L2: âœ…
    sequences_L3: âœ…
    frontend_detail: ğŸ”„
    backend_detail: ğŸ”„
    test_cases: ğŸ”„
    design_detail: ğŸ”„

# å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«å‚ç…§ãƒãƒƒãƒ”ãƒ³ã‚°
implementation_mapping:
  # ä¸»è¦ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
  main_app: "frontend/src/App.jsx"
  main_api: "backend/main.py"
  ai_service: "backend/ai_agent/main.py"

  # Manager Classes (PR #6 - 2025-10-11 å®Ÿè£…)
  project_manager: "frontend/src/classes/ProjectManager.js"
  event_handlers_manager: "frontend/src/classes/EventHandlersManager.js"
  app_settings_manager: "frontend/src/classes/AppSettingsManager.js"

  # éŸ³å£°å‡¦ç†
  audio_engine: "frontend/src/utils/unifiedAudioSystem.js"
  midi_editor: "frontend/src/components/EnhancedMidiEditor.jsx"

  # ArrangementView Module (PR #6 - ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–)
  arrangement_view: "frontend/src/components/ArrangementView.jsx"
  arrangement_hooks: "frontend/src/components/ArrangementView/hooks/"
  arrangement_components: "frontend/src/components/ArrangementView/components/"

  # AIAssistant Module (PR #6 - å†æ§‹æˆ)
  ai_chat: "frontend/src/components/AIassistant/AIAssistantChatBox.jsx"
  ai_chat_components: "frontend/src/components/AIassistant/"

  # DrumTrack Module (PR #6 - å†æ§‹ç¯‰)
  drum_track_main: "frontend/src/components/DrumTrack/DrumTrack.jsx"
  drum_track_hooks: "frontend/src/components/DrumTrack/hooks/"
  drum_track_components: "frontend/src/components/DrumTrack/"

  # Backend
  diffsinger: "backend/diffsinger/"
  ghost_text: "backend/ghost_text/"

  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
  project_menu: "frontend/src/components/ProjectMenu.jsx"
  persistence: "frontend/src/hooks/useMidiPersistence.js"

  # è¨­å®š
  vite_config: "frontend/vite.config.js"
  package_json: "frontend/package.json"
  requirements: "backend/requirements.txt"

# ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
metadata:
  creation_date: "2025-01-22"
  last_major_update: "2025-10-11"
  version_history:
    - version: "2.0.0"
      date: "2025-01-22"
      changes: "éšå±¤å‹ä»•æ§˜æ›¸2.0ã¸ã®ç§»è¡Œã€ç¾åœ¨å®Ÿè£…ãƒ™ãƒ¼ã‚¹åŒ–"
    - version: "2.1.0"
      date: "2025-10-11"
      changes: "PR #6 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åæ˜ : Manager Classeså°å…¥ã€ArrangementView/AIAssistant/DrumTrackãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–"

  contributors:
    - role: "Product Manager"
      name: "System Architect"
    - role: "Technical Writer"
      name: "Claude"

  review_schedule:
    frequency: "monthly"
    next_review: "2025-02-22"
    reviewers: ["CTO", "Lead Developer", "Product Manager"]